function detectBrowser(){var e=navigator.userAgent.toLowerCase(),t=-1<e.indexOf("qqbrowser")||-1<e.indexOf("mqqbrowser"),e=-1<e.indexOf("chrome")&&!t;return document.documentElement.classList.add("browser-chrome"),{isQQBrowser:t,isChrome:e}}var _animateCursor,mouseX,mouseY,currentX,currentY,browserInfo=detectBrowser(),cursorGlow=(console.log("Browser detection:",browserInfo),window.addEventListener("load",function(){setTimeout(function(){var e=document.getElementById("loader");e&&(e.style.display="none")},1e3)}),document.getElementById("cursorGlow"));function createStars(){var e=document.getElementById("stars");if(e)for(var t=0;t<100;t++){var n=document.createElement("div");n.className="star",n.style.width=3*Math.random()+"px",n.style.height=n.style.width,n.style.left=100*Math.random()+"%",n.style.top=100*Math.random()+"%",n.style.animationDelay=3*Math.random()+"s",e.appendChild(n)}}function toggleSidebar(){var e=document.getElementById("sidebar"),t=document.getElementById("overlay");e&&t&&(e.classList.toggle("active"),t.classList.toggle("active"))}cursorGlow&&(_animateCursor=function(){currentX+=.1*(mouseX-currentX),currentY+=.1*(mouseY-currentY),cursorGlow.style.left=currentX+"px",cursorGlow.style.top=currentY+"px",requestAnimationFrame(_animateCursor)},currentY=currentX=mouseY=mouseX=0,document.addEventListener("mousemove",function(e){mouseX=e.clientX,mouseY=e.clientY}),_animateCursor()),createStars();var lastScrollTop=0,navItems=(window.addEventListener("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop,t=document.getElementById("topNav");t&&(t.style.transform=lastScrollTop<e&&100<e?"translateY(-100%)":"translateY(0)"),lastScrollTop=e<=0?0:e}),document.querySelectorAll(".nav-item")),toolBtns=(navItems.forEach(function(t){t.addEventListener("click",function(e){navItems.forEach(function(e){return e.classList.remove("active")}),t.classList.add("active")})}),document.querySelectorAll(".tool-btn")),postCards=(toolBtns.forEach(function(e){e.addEventListener("click",function(){var e=this;this.style.transform="scale(0.95)",setTimeout(function(){e.style.transform=""},100)})}),document.querySelectorAll(".post-card")),tags=(postCards.forEach(function(o){o.addEventListener("mousemove",function(e){var t=o.getBoundingClientRect(),n=e.clientX-t.left,n=(t.width/2-n)/20;o.style.transform="perspective(1000px) rotateX(".concat((e.clientY-t.top-t.height/2)/20,"deg) rotateY(").concat(n,"deg) scale(1.02) translateZ(10px)")}),o.addEventListener("mouseleave",function(){o.style.transform=""})}),document.querySelectorAll(".tag"));tags.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=document.createElement("span"),n=(t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.style.background="rgba(255, 255, 255, 0.3)",t.style.borderRadius="50%",t.style.transform="translate(-50%, -50%) scale(0)",t.style.animation="rippleEffect 0.6s ease-out",this.getBoundingClientRect());t.style.left=e.clientX-n.left+"px",t.style.top=e.clientY-n.top+"px",this.appendChild(t),setTimeout(function(){return t.remove()},600)})}),document.querySelectorAll('a[href^="#"]').forEach(function(e){e.addEventListener("click",function(e){var t=this.getAttribute("href");if("#"===t)e.preventDefault();else try{var n=document.querySelector(t);n&&(e.preventDefault(),n.scrollIntoView({behavior:"smooth"}))}catch(e){console.warn("Smooth scroll target not found or invalid selector:",t)}})}),(()=>{var e,n,t=(t=window.performance.timing).loadEventEnd-t.navigationStart;function o(){var e=document.getElementById("sidebar"),t=document.getElementById("overlay");e&&t&&(e.classList.toggle("active"),t.classList.toggle("active"))}function r(){navigator.connection&&navigator.connection.effectiveType.includes("4g")&&[{href:"/assets/fonts/main-font.woff2",as:"font",type:"font/woff2",crossorigin:"anonymous"},{href:"/assets/images/hero-bg.jpg",as:"image"}].forEach(function(e){var t=document.createElement("link");t.rel="preload",t.href=e.href,t.as=e.as,e.type&&(t.type=e.type),e.crossorigin&&(t.crossOrigin=e.crossorigin),document.head.appendChild(t)})}console.log("页面加载时间:",t+"ms"),"loading"in HTMLImageElement.prototype?(e=document.querySelectorAll('img[loading="lazy"]'),console.log("使用原生懒加载支持:",e.length,"张图片")):(e=document.querySelectorAll("img[data-src]"),n=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&((e=e.target).src=e.dataset.src,e.dataset.srcset&&(e.srcset=e.dataset.srcset),e.classList.add("loaded"),n.unobserve(e))})}),e.forEach(function(e){n.observe(e)})),document.addEventListener("DOMContentLoaded",function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("ServiceWorker 注册成功，作用域：",e.scope)}).catch(function(e){console.log("ServiceWorker 注册失败：",e)})});var e=document.querySelector(".menu-btn"),t=(document.getElementById("sidebar"),document.getElementById("overlay")),n=(e&&e.addEventListener("click",o),t&&t.addEventListener("click",o),document.getElementById("cursorGlow"));n&&document.addEventListener("mousemove",function(e){requestAnimationFrame(function(){n.style.left=e.clientX+"px",n.style.top=e.clientY+"px"})}),document.querySelectorAll("img:not([loading])").forEach(function(e){e.hasAttribute("loading")||e.setAttribute("loading","lazy"),e.addEventListener("error",function(){this.classList.add("error")})})}),window.toggleSidebar=o,"requestIdleCallback"in window?requestIdleCallback(function(){r()}):setTimeout(r,1e3)})();